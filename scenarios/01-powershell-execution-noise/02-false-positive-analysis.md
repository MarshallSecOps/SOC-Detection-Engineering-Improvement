# False Positive Analysis â€“ PowerShell Execution Noise

## Purpose
This document analyses why the baseline PowerShell execution alert produces a high false positive rate and identifies **recurring benign patterns** observed during investigation.

Understanding false positives is critical to improving alert fidelity and reducing SOC analyst workload.

---

## Summary of Findings
The majority of alerts generated by the baseline detection represent **legitimate user or administrative activity**, not malicious behavior.

False positives consistently fall into a small number of predictable categories that can be identified through contextual analysis.

---

## Common False Positive Patterns Identified

### 1. User-Initiated Execution via Explorer
**Observed Pattern:**
- Parent process: `explorer.exe`
- PowerShell launched via GUI interaction (double-click, right-click, shortcut)

**Why This Is Benign:**
- Indicates direct user intent
- Common for running personal scripts or automation
- Rarely used by attackers for initial execution

---

### 2. Transparent Script Execution
**Observed Pattern:**
- Use of `-File` parameter
- Clear, readable script paths
- No inline commands

**Why This Is Benign:**
- Script contents are visible on disk
- No attempt to hide logic
- Attackers typically prefer inline or encoded execution

---

### 3. Script Location in User Directories
**Observed Pattern:**
- Script paths under:
  - `C:\Users\<user>\Documents`
  - `C:\Users\<user>\Desktop`

**Why This Is Benign:**
- Common locations for personal automation
- Attackers more often use:
  - `%APPDATA%`
  - `%TEMP%`
  - `C:\ProgramData`
  - Randomised directories

---

### 4. Absence of Obfuscation or Encoding
**Observed Pattern:**
- No `-EncodedCommand`
- No base64 content
- No dynamic execution (`IEX`, `Invoke-Expression`)

**Why This Is Benign:**
- Legitimate scripts do not require obfuscation
- Encoding is a strong indicator of malicious intent when present

---

### 5. Medium Integrity Execution
**Observed Pattern:**
- Integrity level: Medium
- No elevation or SYSTEM-level execution

**Why This Is Benign:**
- Limits potential impact
- Malicious PowerShell often seeks elevated or SYSTEM context

---

### 6. Predictable and Repeated Timing
**Observed Pattern:**
- Regular execution intervals
- Consistent timing across events

**Why This Is Benign:**
- Indicative of scheduled tasks or testing
- Attackers typically introduce randomness to evade detection

---

## Why the Baseline Alert Is Noisy
The baseline detection treats **all execution policy bypass usage equally**, without accounting for:

- Execution context
- User interaction
- Obfuscation
- Privilege level
- Script transparency

As a result:
- Legitimate activity dominates alert volume
- Analysts repeatedly close alerts as false positives
- Confidence in the detection erodes over time

---

## Implications for SOC Operations
- Analyst time is wasted validating harmless activity
- Alert fatigue increases
- Real malicious PowerShell usage becomes harder to spot
- Escalation decisions become inconsistent

This reinforces the need for **context-aware detection engineering** rather than indicator-only alerts.

---

## Conclusion
False positives in PowerShell detections are **predictable and preventable**.

By identifying and documenting benign execution patterns, detections can be refined to:
- Reduce noise
- Improve analyst confidence
- Surface genuinely suspicious PowerShell activity

This analysis directly informs the tuned detection logic implemented in the next stage of this scenario.
